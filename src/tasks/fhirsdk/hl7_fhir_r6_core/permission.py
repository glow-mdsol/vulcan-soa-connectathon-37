# WARNING: This file is autogenerated by FHIR Schema Codegen.
# https://github.com/fhir-schema/fhir-schema-codegen
# Any manual changes made to this file may be overwritten.

from __future__ import annotations
from pydantic import BaseModel, ConfigDict, Field, PositiveInt
from typing import List as PyList, Literal

from fhirsdk.hl7_fhir_r6_core.base import \
    BackboneElement, CodeableConcept, Coding, Expression, Identifier, Period, Reference
from fhirsdk.hl7_fhir_r6_core.domain_resource import DomainResource
from fhirsdk.hl7_fhir_r6_core.resource_families import DomainResourceFamily


class PermissionJustification(BackboneElement):
    model_config = ConfigDict(validate_by_name=True, serialize_by_alias=True, extra="forbid")
    
    basis: PyList[CodeableConcept] | None = Field(None, alias="basis", serialization_alias="basis")
    evidence: PyList[Reference] | None = Field(None, alias="evidence", serialization_alias="evidence")

class PermissionRule(BackboneElement):
    model_config = ConfigDict(validate_by_name=True, serialize_by_alias=True, extra="forbid")
    
    activity: PyList[PermissionRuleActivity] | None = Field(None, alias="activity", serialization_alias="activity")
    data: PyList[PermissionRuleData] | None = Field(None, alias="data", serialization_alias="data")
    import_: Reference | None = Field(None, alias="import", serialization_alias="import")
    limit: PyList[PermissionRuleLimit] | None = Field(None, alias="limit", serialization_alias="limit")
    type: Literal["deny", "permit"] | None = Field(None, alias="type", serialization_alias="type")

class PermissionRuleActivity(BackboneElement):
    model_config = ConfigDict(validate_by_name=True, serialize_by_alias=True, extra="forbid")
    
    action: PyList[CodeableConcept] | None = Field(None, alias="action", serialization_alias="action")
    actor: PyList[PermissionRuleActivityActor] | None = Field(None, alias="actor", serialization_alias="actor")
    purpose: PyList[CodeableConcept] | None = Field(None, alias="purpose", serialization_alias="purpose")

class PermissionRuleActivityActor(BackboneElement):
    model_config = ConfigDict(validate_by_name=True, serialize_by_alias=True, extra="forbid")
    
    reference: Reference | None = Field(None, alias="reference", serialization_alias="reference")
    role: CodeableConcept | None = Field(None, alias="role", serialization_alias="role")

class PermissionRuleData(BackboneElement):
    model_config = ConfigDict(validate_by_name=True, serialize_by_alias=True, extra="forbid")
    
    expression: Expression | None = Field(None, alias="expression", serialization_alias="expression")
    period: Period | None = Field(None, alias="period", serialization_alias="period")
    resource: PyList[PermissionRuleDataResource] | None = Field(None, alias="resource", serialization_alias="resource")
    security: PyList[Coding] | None = Field(None, alias="security", serialization_alias="security")

class PermissionRuleDataResource(BackboneElement):
    model_config = ConfigDict(validate_by_name=True, serialize_by_alias=True, extra="forbid")
    
    meaning: Literal["instance", "related", "dependents", "authoredby"] = Field(alias="meaning", serialization_alias="meaning")
    reference: Reference = Field(alias="reference", serialization_alias="reference")

class PermissionRuleLimit(BackboneElement):
    model_config = ConfigDict(validate_by_name=True, serialize_by_alias=True, extra="forbid")
    
    control: PyList[CodeableConcept] | None = Field(None, alias="control", serialization_alias="control")
    element: PyList[str] | None = Field(None, alias="element", serialization_alias="element")
    tag: PyList[Coding] | None = Field(None, alias="tag", serialization_alias="tag")


class Permission(DomainResource):
    model_config = ConfigDict(validate_by_name=True, serialize_by_alias=True, extra="forbid")
    
    resource_type: str = Field(
        default='Permission',
        alias='resourceType',
        serialization_alias='resourceType',
        frozen=True,
        pattern='Permission'
    )
    
    asserter: Reference | None = Field(None, alias="asserter", serialization_alias="asserter")
    combining: Literal["deny-overrides", "permit-overrides", "ordered-deny-overrides", "ordered-permit-overrides", "deny-unless-permit", "permit-unless-deny"] = Field(alias="combining", serialization_alias="combining")
    date: PyList[str] | None = Field(None, alias="date", serialization_alias="date")
    identifier: PyList[Identifier] | None = Field(None, alias="identifier", serialization_alias="identifier")
    justification: PermissionJustification | None = Field(None, alias="justification", serialization_alias="justification")
    rule: PyList[PermissionRule] | None = Field(None, alias="rule", serialization_alias="rule")
    status: Literal["active", "entered-in-error", "draft", "rejected"] = Field(alias="status", serialization_alias="status")
    validity: Period | None = Field(None, alias="validity", serialization_alias="validity")
    
    def to_json(self, indent: int | None = None) -> str:
        return self.model_dump_json(exclude_unset=True, exclude_none=True, indent=indent)
    
    @classmethod
    def from_json(cls, json: str) -> Permission:
        return cls.model_validate_json(json)

